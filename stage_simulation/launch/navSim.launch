<?xml version="1.0"?>

<launch>
	<param name="use_sim_time" value="true"/>

	<node pkg="stage_ros" type="stageros" name="stageros" args="-d $(find stage_simulation)/worlds/basic.world"/>

	<!--node name="static_tf0" pkg="tf" type="static_transform_publisher" args="2 0 0 0 0 0 /map /base_footprint 100"/-->
	<remap from="scan" to="base_scan"/>
	<node pkg="rviz" type="rviz" name="rviz"/>

        <node	pkg="amcl" type="amcl" name="amcl">
		<param name="use_map_topic" value="true"/>
		<param name="base_frame_id" value="base_footprint"/>
                <param name="tf_broadcast" value="false"/>
                <param name="odom_model_type" value="diff-corrected"/>
        </node>

	<!--node pkg="map_server" type="map_server" name="map_server" args="$(find stage_simulation)/worlds/maps/basic_map_scanned.yaml"/-->

	<node pkg="costmap_2d" type="costmap_2d_node" name="costmap_2d_node">
		<rosparam file="$(find stage_simulation)/launch/costmap_common_params.yaml" ns="costmap"/>
		<rosparam file="$(find stage_simulation)/launch/local_costmap_params.yaml" ns="costmap"/>
		<!--rosparam file="$(find stage_simulation)/launch/global_costmap_params.yaml" ns="costmap"/-->
	</node>

	<node pkg="move_base" type="move_base" name="move_base" output="screen">
		<rosparam file="$(find stage_simulation)/launch/costmap_common_params.yaml" command="load" ns="global_costmap"/>
		<rosparam file="$(find stage_simulation)/launch/costmap_common_params.yaml" command="load" ns="local_costmap"/>
		<rosparam file="$(find stage_simulation)/launch/local_costmap_params.yaml" command="load"/>
		<rosparam file="$(find stage_simulation)/launch/global_costmap_params.yaml" command="load"/>
		<rosparam file="$(find stage_simulation)/launch/base_local_planner_params.yaml" command="load"/>
	</node>

  <node pkg="gmapping" type="slam_gmapping" name="slam_gmapping">
    <param name="base_frame" value="base_footprint"/>
    <param name="map_frame" value="map"/>
    <param name="odom_frame" value="odom"/>
  </node>

</launch>
